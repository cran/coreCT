<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Introduction</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h2>Introduction</h2>

<p>Computed Tomography (CT) imaging has many applications outside the medical field. One such application in the field of environmental science is scanning sediment cores from coastal wetlands, a technique first demonstrated by Davey et al. (2011)<sup>[Davey,</sup> E., C. Wigand, R. Johnson, K. Sundberg, J. Morris, and C. Roman. 2011. Use of computed tomography imaging for quantifying coarse roots, rhizomes, peat, and particle densities in marsh soils. Ecological Applications 21(6): 2156-2171. 
(<a href="https://www.researchgate.net/profile/Cathleen_Wigand/publication/51662596_Use_of_computed_tomography_imaging_for_quantifying_coarse_roots_rhizomes_peat_and_particle_densities_in_marsh_soils/links/545a34ce0cf2cf5164843a60.pdf">link to .pdf</a>)]. The general goal is typically to quantify various soil/sediment components (particles, sand, water, roots) based on their densities; see sources citing Davey et al. (2011) for specific applications.</p>

<p>CT scanning produces large matrices of metadata-rich files with the .dcm extension. The extension is derived from data standard used in CT scanning, called Digital Imaging and Communications in Medicine (DICOM). The <strong>coreCT</strong> package is a small but powerful set of functions designed to streamline analysis of CT-scanned sediment cores, enabling rapid programmatic processing and synthesis of semi-processed DICOM images. &#39;Semi-processed&#39; means that irrelevant parts of the images (PVC core tubes, etc.) have been masked out, and the only remaining data are for the actual sediment. <strong>coreCT</strong> builds on functionality in other packages, particulary the <strong>oro.dicom</strong> package (Whitcher et al. 2011)<sup>[Whitcher,</sup> B., V. J. Schmid and A. Thornton. 2011. Working with the DICOM and NIfTI Data Standards in R. Journal of Statistical Software 44(6): 1-28. 
(<a href="http://www.jstatsoft.org/v44/i06">link</a>)] for reading DICOM images and spatial analysis tools in the <strong>raster</strong> and <strong>igraph</strong> packages.</p>

<p>Key features of <strong>coreCT</strong> include:</p>

<ul>
<li>An integrated workflow, from conversion of DICOM files to image analysis</li>
<li>Internal calculation of the abundance (area, volume, wet mass) of seven sediment components: air, live roots and rhizomes, water, peat, particles, sand, and rock/shell</li>
<li>Quantification of root characteristics: external surface area, volume, and mass of roots in user-defined size classes</li>
</ul>

<p>This vignette introduces basic usage of the <strong>coreCT</strong> functions.</p>

<h2>Data: core_426</h2>

<p>The <code>core_426</code> sample dataset included with <strong>coreCT</strong> includes three DICOM images from a CT-scanned sediment core. Each image represents a 0.625 mm depth interval, so this dataset is very small and only useful for demonstration purposes. </p>

<p>We&#39;ll use this provided dataset to demonstrate how the basic functions , <code>coreHist</code>, <code>conv</code>, and <code>rootSize</code> work. The latter two functions work with a matrix of DICOM images already in the working environment, but <strong>coreCT</strong> also includes wrapper functions <code>convDir</code> and <code>rootSizeDir</code> that are more flexible, operating on a directory of raw .dcm files and determining inputs like voxel volumes and slice thicknesses by automatically extracting metadata. These wrapper functions load the DICOM images, extract relevant metadata, and analyze the images for components and root characteristics.</p>

<h2>Basic usage</h2>

<p>Using the basic functions requires some initial work to extract metadata and convert the raw values to Hounsfield Units, the standard units for CT output.</p>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/></p>

<p>This can be done more easily with coreCT::convDir, which automatically extracts DICOM metadata associated with pixel dimensions and converts raw values to Hounsfield Units:</p>

<pre><code class="r">materials &lt;- convDir(&quot;core_426&quot;)

plot(-depth ~ peat.cm3, data = materials, xlab = &quot;Peat volume (cm3; per slice)&quot;, ylab = &quot;Depth (cm)&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-2"/></p>

<h2>Examining component distributions</h2>

<p>The conversion from Hounsfield Units to particle densities is done using calibration rods of known density analyzed with the sediment core. Reasonable default values are provided for four calibrants following Davey et al. (2011): air, water, colloidal silica, and glass. These values are used to define thresholds between soil components. These thresholds, and the distribution of values in the whole data series, can be visualized and returned by <code>coreHist</code>:</p>

<pre><code class="r">HUfreq &lt;- coreHist(&quot;core_426&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-3"/></p>

<pre><code class="r">names(HUfreq)
</code></pre>

<pre><code>## [1] &quot;histData&quot; &quot;splits&quot;
</code></pre>

<pre><code class="r">HUfreq$splits
</code></pre>

<pre><code>##     material lower upper
## 1        air -1025  -773
## 2         RR  -773    50
## 3      water    50    78
## 4       peat    78   311
## 5  particles   311   750
## 6       sand   750  1390
## 7 rock_shell  1390  3045
</code></pre>

<p><code>conv</code> uses these calibration data to classify voxels into material classes and then calculate four quantities for each of the seven material classes, for each image: (1) average Hounsfield units, (2) total 2D surface area (\(cm^2\)), (3) volume (\(cm^3\)), and (4) mass (g). </p>

<p>The 2D surface area (\(cm^2\)) is calculated as simply the number of pixels in each class, multiplied by the pixel area. Multiplying 2D surface area by the image thickness provides the volume of each component (reported in \(cm^3\)). The relationship between calibration rod Hounsfield units and particle densities is then applied to estimate component masses, by multiplying each voxel&#39;s bulk density by its volume (\(g.cm^3 * cm^3 = g\)).</p>

<h2>Focusing on roots and rhizomes</h2>

<p>Root characteristics are calculated by the <code>rootSize</code> function, which also has a wrapper function <code>rootSizeDir</code> that operates on a directory of raw DICOM images.</p>

<p>By default, root characteristics are calculated when <code>convDir</code> is used, but if root data aren&#39;t of interest or a separate set of DICOM images is being used to quantify roots, time can be saved by including <code>rootData = FALSE</code> as an argument to <code>convDir</code>.</p>

<p>Conversely, root characteristics can be analyzed without quantifying sediment composition. This uses the <code>rootSize</code> function and its metadata-scraping wrapper function, <code>rootSizeDir</code>:</p>

<pre><code class="r">rootChars &lt;- rootSizeDir(&quot;core_426&quot;, diameter.classes = c(1, 2.5, 10))

plot(-depth ~ structures, data = rootChars, xlab = &quot;Root structures (per slice)&quot;, ylab = &quot;Depth (cm)&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-4"/></p>

</body>

</html>
